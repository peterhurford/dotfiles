#wrapper
  #content-wrap
    #content
      #content-outer
        #content-inner
          = render partial: '/admin/nav_bar'
          #sidebar-separator
            %section.clearfix#main
              .page-header#main-header
                %h1#main-heading Associated Promotions
              #main-content
                .widget-content.table-container
                - if @promotion_instances.blank?
                  No promotion instances currently exist.
                - else
                  %table#promotions.table.table-striped.table-flipscroll.display
                    %thead
                      %tr
                        %th ID
                        %th Customer
                        %th Product
                        %th Promotion Name
                        %th Rule Type
                        %th Amount
                        %th Payments Count
                        %th Applicable?
                        %th Status
                      
                        - @promotion_instances.each do |promotion_instance|
                          %tr
                            %td= promotion_instance.id
                            - if promotion_instance.customer_application.present?
                              %td= link_to(promotion_instance.customer_name, admin_customer_path(promotion_instance.customer_application.customer_id))
                            - else
                              %td No record
                            - if promotion_instance.promotable.is_a? Loan
                              %td= link_to(promotion_instance.promotable.id, admin_loan_path(promotion_instance.promotable.id))
                            - elsif promotion_instance.promotable.is_a? CreditLine
                              %td= link_to(promotion_instance.promotable.id, admin_credit_line_path(promotion_instance.promotable.id))
                            - else
                              %td Not Found
                            - if promotion_instance.promotion.present?
                              %td= link_to(promotion_instance.promotion.name, admin_promotions_path)
                              %td= promotion_instance.promotion.rule_type
                              %td= promotion_instance.promotion.rule_amount.to_money
                            - else
                              %td No record
                              %td
                              %td
                            %td= promotion_instance.payments_display
                            %td= promotion_instance.applicable_display
                            %td= promotion_instance.status
                  %br
                  %br
                  .pull-right{ :style => "padding-right:20px;" }= will_paginate @promotion_instances
                  = link_to "List of Promotions", admin_promotions_path
