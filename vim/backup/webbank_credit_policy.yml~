# CPML: Credit Policy Markup Language
# This YAML file holds the WebBank Credit Policy, and a test suite in webbank_validator_test.rb tests against this file.
# Also, an after-save check in the Credit Decision model uses this file to ensure compliance with the WebBank policy.

# HOW TO USE:

# {variable of interest as written in the credit decision engine}: {comparison operator} {number or variable}
# comparison operators are GT for >, LT for <, GTE for >=, LTE for <=, EQ for ==, and NEQ for !=

# Flags can be used to define special calculations
  # The $var flag allows the use of variables in the credit decision engine (e.g., "GT $var:monthly_net_income")
  # The $time flag allows the use of months and years and coverts to dates (e.g., "GT 6 $time:months")
  # % automatically triggers conversion to decimal (e.g., "LTE 36%" will be LTE 0.36)
  # +, -, /, and * automatically trigger math evaluation (e.g., "LT 2 + 2" will evaluate to LT 4)
    # Note that all math statements must be space separated (e.g., GOOD: 2 + 2, BAD: 2+2)


credit_decision_I:
    fico_score: GT 599
    dob: GT 18 $time:years
    count_tradelines: GT 2
    amount_monthly_minimum_payments: LTE $var:monthly_net_income * 0.7
    amount_non_medical_collections: LT 1
    amount_past_due_on_open_tradelines: LT 1
    newest_bankruptcy_date: LT 6 $time:months
    total_bankruptcies_count: LTE 1
    dismissed_bankruptcies_count: LTE 0
    has_open_bankruptcy: EQ false
    amount_tax_liens: LTE 1
    amount_civil_judgements: LTE 1
    amount_child_support: LTE 1
    count_tradelines_with_recent_payments: GTE 1
    count_30_days_past_due_active_tradelines: LTE 0
    count_60_days_past_due_active_tradelines: LTE 0
    count_90_days_past_due_active_tradelines: LTE 0
    count_120_days_past_due_active_tradelines: LTE 0
    has_thin_tu_file: EQ false  # Credit history

credit_decision_II:
    microbilt_bad_loans_count: LTE 0
    microbilt_score: GTE 200
    #clarity_deliquent_open_or_active_loans: LTE 0 #-- Cannot be tested because the variable is not out yet
    has_recent_6_month_microbilt_loan: EQ false
    has_recent_12_month_microbilt_loan: EQ false

loan_terms_summary_I:
    apr: GTE 19%
    apr: LTE 36%
    max_term: GTE 12
    max_term: LTE 48
    minimum_borrow_amount: GTE 1000
    maximum_borrow_amount: LTE 20000
    maximum_borrow_amount: LTE $var:monthly_net_income * 300%
    maximum_monthly_payment: LTE $var:monthly_net_income * 18%
    minimum_monthly_payment: LTE $var:monthly_net_income * 4%

loan_terms_summary_II:
    model_decline_score: LTE 0.15
