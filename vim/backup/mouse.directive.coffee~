'use strict'

angular.module 'threeManChessApp'
.factory 'Mouse', (scope) ->
  scope.cartesianToPolar = (x, y) ->
    r = Math.sqrt(x*x + y*y)
    theta = Math.atan(y/x) / (2 * Math.PI) * 360
    theta += 180 if x < 0
    theta += 360 if x > 0 and y < 0
    {r: r, theta: theta}

  write: (ctx, canvas, message) ->
    ctx.clearRect(0, 0, canvas.width/2, 40)
    ctx.font = '18pt Calibri'
    ctx.fillStyle = 'black'
    ctx.fillText(message, 10, 25)
  
  getMousePos: (canvas, e) ->
    rect = canvas.getBoundingClientRect()
    x = e.clientX - rect.left - 300
    y = e.clientY - rect.top - 300
    polar_c = scope.cartesianToPolar(x, y)
    {
      x: Math.floor(polar_c.theta / 15),
      y: 5 - Math.floor((polar_c.r - 75) / 35)
    }
